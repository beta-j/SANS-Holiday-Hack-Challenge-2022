# OBJECTIVE 6 - Recover the Burining Ring of Fire #
## 6C - Exploit a Smart Contract ##

### OBJECTIVE : ###
>Exploit flaws in a smart contract to buy yourself a Bored Sporc NFT. Find hints for this objective hidden throughout the tunnels.
#  

## HINTS: ##
<details>
  <summary>Hints provided for Objective 6B</summary>
  
>-	You can change something that you shouldn't be allowed to change. [This repo]([url](https://github.com/QPetabyte/Merkle_Trees)) might help!
>-	Youâ€™re going to need a [Merkle Tree](https://decentralizedthoughts.github.io/2020-12-22-what-is-a-merkle-tree/) of your own.  Math is hard.  [Professor Petabyte](https://www.youtube.com/watch?v=Qt_RWBq63S8) can help you out.


</details>

#  

## PROCEDURE : ##
It looks like Professor Petabyteâ€™s repo is a great starting point for this challenge.  By installing the docker container and running the provided python script we can generate the root and proof values for any two wallet addresses in a Merkle Tree.  Of course â€“ one of the wallet addresses must be our own and reading through the presale approval page gives us the second wallet address that we need.
![image](https://github.com/beta-j/SANS-Holiday-Hack-Challenge-2022/assets/60655500/e83ebe4e-c74e-4330-8a2e-f479f01e1832)

Now we can plug these in to professor petabyteâ€™s Merkle-tree generator script and obtain the corresponding root and proof values.  
![image](https://github.com/beta-j/SANS-Holiday-Hack-Challenge-2022/assets/60655500/dc011f68-1d77-46b9-a1f2-78289ecf871a)

If we try submitting our wallet address and proof values in the presale terminal, the website will calculate the root value and compare it to a known root value to determine whether or not we are really on the presale list.  If only there was a way to change the root value!

Looking closely at the siteâ€™s javascript, we can see that the root value is passed on as a variable in `bsrs.js`:	
``var root = '0x52cfdfdcba8efebabd9ecc2c60e6f482ab30bdc6acf8f9bd0600de83701e15f1';``

We can easily fool the website into reading a different variable by intercepting the webpage with BurpSuite and changing the root value to that generated by Professor Petabyteâ€™s script.  Just like that â€“ weâ€™re on the list ðŸ˜Š  

![image](https://github.com/beta-j/SANS-Holiday-Hack-Challenge-2022/assets/60655500/aa0d4a9b-c524-4e2a-b2e9-6d3344a9cddd)

All that remains is to pre-approve a 100KC payment to the SPORC address we found earlier and repeat the process and we are now the proud owner of BSRS Token `#000680`.
```
Transaction: 0xa7f9058c68462bbc9c642c7cb2f5986b57776138296769fffa151138613e2543, Block: 108511
```

Cute fellow eh? â€“ well worth a 100KC and some two hours of head scratching, right?

![image](https://github.com/beta-j/SANS-Holiday-Hack-Challenge-2022/assets/60655500/adfa8157-9a3a-4b18-b576-2056ba5903bd)

Oh and weâ€™ve also recovered the **Burning Ring of Fire** â€“ hooray!â€ƒ

